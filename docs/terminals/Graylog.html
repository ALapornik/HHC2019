

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Graylog &mdash; HHC2019  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mongo Pilfer" href="MongoPilfer.html" />
    <link rel="prev" title="Nyanshell" href="Nyanshell.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> HHC2019
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Objectives:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../objectives/summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question0.html">0) Talk to Santa in the Quad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question1.html">1) Find the Turtle Doves</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question2.html">2) Unredact Threatening Document</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question3.html">3) Windows Log Analysis: Evaluate Attack Outcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question4.html">4) Windows Log Analysis: Determine Attacker Technique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question5.html">5) Network Log Analysis: Determine Compromised System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question6.html">6) Splunk</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question7.html">7) Get Access To The Steam Tunnels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question8.html">8) Bypassing the Frido Sleigh CAPTEHA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question9.html">9) Retrieve Scraps of Paper from Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question10.html">10) Recover Cleartext Document</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question11.html">11) Open the Sleigh Shop Door</a></li>
<li class="toctree-l1"><a class="reference internal" href="../objectives/question12.html">12) Filter Out Poisoned Sources of Weather Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Terminals:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="EscapeEd.html">Escape Ed</a></li>
<li class="toctree-l1"><a class="reference internal" href="LinuxPath.html">Linux Path</a></li>
<li class="toctree-l1"><a class="reference internal" href="XmasCheerLaser.html">Xmas Cheer Laser</a></li>
<li class="toctree-l1"><a class="reference internal" href="FrostyKeypad.html">Frosty Keypad</a></li>
<li class="toctree-l1"><a class="reference internal" href="HolidayHackTrail.html">Holiday Hack Trail</a></li>
<li class="toctree-l1"><a class="reference internal" href="Nyanshell.html">Nyanshell</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Graylog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#challenge">Challenge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#solution">Solution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#question-1">Question 1:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#answer">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-answer-dialog">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-notes">Additional Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-2">Question 2:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Additional Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-3">Question 3:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">Additional Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-4">Question 4:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Additional Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-5">Question 5:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">Additional Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-6">Question 6:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">Additional Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-7">Question 7:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id17">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">Additional Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-8">Question 8:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additonal-notes">Additonal Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-9">Question 9:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24">Additonal Notes:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#question-10">Question 10:</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id25">Answer:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26">Post-Answer Dialog:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">Additional Notes:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hints">Hints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MongoPilfer.html">Mongo Pilfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="SmartBraces.html">Smart Braces</a></li>
<li class="toctree-l1"><a class="reference internal" href="ZeekJSONAnalysis.html">Zeek JSON Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendices/narrative.html">Narrative</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HHC2019</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Graylog</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1><a class="reference external" href="https://incident.elfu.org/?challenge=graylog">Graylog</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="challenge">
<h2>Challenge<a class="headerlink" href="#challenge" title="Permalink to this headline">¶</a></h2>
<p>The initial dialog with Pepper Minstix:</p>
<pre class="literal-block"><strong>Pepper Minstix</strong>
Click on the All messages Link to access the Graylog search interface!
Make sure you are searching in all messages!
The Elf U Graylog server has an integrated incident response reporting system.
Just mouse-over the box in the lower-right corner.
Login with the username elfustudent and password elfustudent.</pre>
<p>The hints from our badge:</p>
<pre class="literal-block"><strong>Graylog</strong>
From: Pepper Minstix
<a class="reference external" href="http://docs.graylog.org/en/3.1/pages/queries.html">Graylog Docs</a></pre>
<pre class="literal-block"><strong>Event IDs and Sysmon</strong>
From: Pepper Minstix
(Events and Sysmon)</pre>
</div>
<div class="section" id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h2>
<div class="section" id="question-1">
<h3>Question 1:<a class="headerlink" href="#question-1" title="Permalink to this headline">¶</a></h3>
<p>Minty CandyCane reported some weird activity on his computer after he clicked on a link in Firefox for a cookie recipe and downloaded a file.</p>
<p>What is the full-path + filename of the first malicious file downloaded by Minty?</p>
<div class="section" id="answer">
<h4>Answer:<a class="headerlink" href="#answer" title="Permalink to this headline">¶</a></h4>
<p><strong>C:\Users\minty\Downloads\cookie_recipe.exe</strong></p>
</div>
<div class="section" id="post-answer-dialog">
<h4>Post-Answer Dialog:<a class="headerlink" href="#post-answer-dialog" title="Permalink to this headline">¶</a></h4>
<p>We can find this searching for sysmon file creation event id <strong>2</strong> with a process named <strong>firefox.exe</strong> and not junk <strong>.temp files</strong>. We can use regular expressions to include or exclude patterns:
<code class="docutils literal notranslate"><span class="pre">TargetFilename:/.+\.pdf/</span></code></p>
</div>
<div class="section" id="additional-notes">
<h4>Additional Notes:<a class="headerlink" href="#additional-notes" title="Permalink to this headline">¶</a></h4>
<p>Our query was:</p>
<p><code class="docutils literal notranslate"><span class="pre">EventID:2</span> <span class="pre">AND</span> <span class="pre">ProcessImage:/.+firefox.exe/</span> <span class="pre">NOT</span> <span class="pre">TargetFilename:/.+\.temp/</span></code></p>
<p>The file was accessed at <strong>2019-11-19 05:28:33.000</strong> which we can consider as the start of the attack. Any records before this time can be considered as out of scope for this investigation.</p>
<p>The machine to which the file was downloaded was <strong>elfu-res-wks1</strong>.</p>
</div>
</div>
<div class="section" id="question-2">
<h3>Question 2:<a class="headerlink" href="#question-2" title="Permalink to this headline">¶</a></h3>
<p>The malicious file downloaded and executed by Minty gave the attacker remote access to his machine. What was the <strong>ip:port</strong> the malicious file connected to first?</p>
<div class="section" id="id2">
<h4>Answer:<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p><strong>192.168.247.175:4444</strong></p>
</div>
<div class="section" id="id3">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>We can pivot off the answer to our first question using the binary path as our <strong>ProcessImage</strong>.</p>
</div>
<div class="section" id="id4">
<h4>Additional Notes:<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>We searched for records containing <strong>cookie_recipe.exe</strong> and containing a <strong>DestinationIp</strong>:
<code class="docutils literal notranslate"><span class="pre">cookie_recipe.exe</span> <span class="pre">AND</span> <span class="pre">_exists_:DestinationIp</span></code></p>
<p>An alternative query based on the post-answer dialog might have been:
<code class="docutils literal notranslate"><span class="pre">ProcessImage:/.+cookie_recipe.exe/</span> <span class="pre">AND</span> <span class="pre">_exists_:DestinationIp</span></code></p>
<p>The destination hostname was <strong>DEFANELF</strong>.</p>
</div>
</div>
<div class="section" id="question-3">
<h3>Question 3:<a class="headerlink" href="#question-3" title="Permalink to this headline">¶</a></h3>
<p>What was the first command executed by the attacker?
(answer is a single word)</p>
<div class="section" id="id5">
<h4>Answer:<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p><strong>whoami</strong></p>
</div>
<div class="section" id="id6">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Since all commands (sysmon event id 1) by the attacker are initially running through the <strong>cookie_recipe.exe</strong> binary, we can set its full-path as our <strong>ParentProcessImage</strong> to find child processes it creates sorting on timestamp.</p>
</div>
<div class="section" id="id7">
<h4>Additional Notes:<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>Our query was:
<code class="docutils literal notranslate"><span class="pre">ParentProcessImage:/.+cookie_recipe.exe/</span></code></p>
<p>The information that we were looking for was in the <strong>CommandLine</strong> field. The command was executed on the <strong>elfu-res-wks1</strong> host.</p>
</div>
</div>
<div class="section" id="question-4">
<h3>Question 4:<a class="headerlink" href="#question-4" title="Permalink to this headline">¶</a></h3>
<p>What is the one-word service name the attacker used to escalate privileges?</p>
<div class="section" id="id8">
<h4>Answer:<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p><strong>webexservice</strong></p>
</div>
<div class="section" id="id9">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>Continuing on using the <strong>cookie_reciper.exe</strong> binary as our <strong>ParentProcessImage</strong>, we should see some more commands later on related to a service.</p>
</div>
<div class="section" id="id10">
<h4>Additional Notes:<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>We used the following query:
<code class="docutils literal notranslate"><span class="pre">ParentProcessImage:/.+cookie_recipe.exe/</span></code></p>
<p>Our records were sorted according to the timestamp. This made it easy to look at the <strong>CommandLine</strong> field until we saw something involving a service.</p>
<p>We found some initial commands generally trying to determine what services were running on the machine. A bit later we saw a command trying to expoit the <strong>webexservice</strong>. The timestamp for this command was <strong>2019-11-19 05:31:02.000</strong>, just a few minutes after the initial file download. The command consisted of the following: <code class="docutils literal notranslate"><span class="pre">C:\Windows\system32\cmd.exe</span> <span class="pre">/c</span> <span class="pre">&quot;cmd.exe</span> <span class="pre">/c</span> <span class="pre">sc</span> <span class="pre">start</span> <span class="pre">webexservice</span> <span class="pre">a</span> <span class="pre">software-update</span> <span class="pre">1</span> <span class="pre">C:\Users\minty\Downloads\cookie_recipe2.exe</span> <span class="pre">&quot;</span></code>. The command was executed on the <strong>elfu-res-wks1</strong> host.</p>
</div>
</div>
<div class="section" id="question-5">
<h3>Question 5:<a class="headerlink" href="#question-5" title="Permalink to this headline">¶</a></h3>
<p>What is the file-path + filename of the binary ran by the attacker to dump credentials?</p>
<div class="section" id="id11">
<h4>Answer:<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p><strong>C:\cookie.exe</strong></p>
</div>
<div class="section" id="id12">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>The attacker elevates privileges using the vulnerable <strong>webexservice</strong> to run a file called <strong>cookie_recipe2.exe</strong>. Let’s use this binary path in our <strong>ParentProcessImage</strong> search.</p>
</div>
<div class="section" id="id13">
<h4>Additional Notes:<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>We used the following query:
<code class="docutils literal notranslate"><span class="pre">ParentProcessImage:/.+cookie_recipe2.exe/</span></code></p>
<p>In the <strong>CommandLine</strong> field we noticed a command at <strong>2019-11-19 05:41:02.000</strong> downloading <strong>mimikatz.exe</strong> and saving it as <strong>C:\cookie.exe</strong>. A few minutes later at <strong>2019-11-19 05:45:14.000</strong> the attacker executed the <strong>cookie.exe</strong> file. The command was executed on the <strong>elfu-res-wks1</strong> host.</p>
</div>
</div>
<div class="section" id="question-6">
<h3>Question 6:<a class="headerlink" href="#question-6" title="Permalink to this headline">¶</a></h3>
<p>The attacker pivoted to another workstation using credentials gained from Minty’s computer. Which account name was used to pivot to another machine?</p>
<div class="section" id="id14">
<h4>Answer:<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p><strong>alabaster</strong></p>
</div>
<div class="section" id="id15">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>Windows Event Id <strong>4624</strong> is generated when a user network logon occurs successfully. We can also filter on the attacker’s IP using <strong>SourceNetworkAddress</strong>.</p>
</div>
<div class="section" id="id16">
<h4>Additional Notes:<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>We used the following query and looked at the <strong>AccountName</strong> field for the account:
<code class="docutils literal notranslate"><span class="pre">EventID:4624</span> <span class="pre">AND</span> <span class="pre">SourceNetworkAddress:192.168.247.175</span></code></p>
<p>The pivot was to the <strong>elfu-res-wks2</strong> host.</p>
</div>
</div>
<div class="section" id="question-7">
<h3>Question 7:<a class="headerlink" href="#question-7" title="Permalink to this headline">¶</a></h3>
<p>What is the time ( HH:MM:SS ) the attacker makes a Remote Desktop connection to another machine?</p>
<div class="section" id="id17">
<h4>Answer:<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p><strong>06:04:28</strong></p>
</div>
<div class="section" id="id18">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p><strong>LogonType 10</strong> is used for successful network connections using the RDP client.</p>
</div>
<div class="section" id="id19">
<h4>Additional Notes:<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>We used the following query although querying on just the <strong>LogonType</strong> would have been OK.
<code class="docutils literal notranslate"><span class="pre">LogonType:10</span> <span class="pre">AND</span> <span class="pre">source:elfu-res-wks2</span></code></p>
<p>The correct record was the one with an <strong>AccountName</strong> and <strong>DestinationHostname</strong>.</p>
</div>
</div>
<div class="section" id="question-8">
<h3>Question 8:<a class="headerlink" href="#question-8" title="Permalink to this headline">¶</a></h3>
<p>The attacker navigates the file system of a third host using their Remote Desktop Connection to the second host. What is the <strong>SourceHostName</strong>,**DestinationHostname**,**LogonType** of this connection?
(submit in that order as csv)</p>
<div class="section" id="id20">
<h4>Answer:<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p><strong>elfu-res-wks2,elfu-res-wks3,3</strong></p>
</div>
<div class="section" id="id21">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>The attacker has GUI access to workstation 2 via RDP. They likely use this GUI connection to access the file system of of workstation 3 using explorer.exe via UNC file paths (which is why we don’t see any cmd.exe or powershell.exe process creates). However, we still see the successful network authentication for this with event id <strong>4624</strong> and logon type <strong>3</strong>.</p>
</div>
<div class="section" id="additonal-notes">
<h4>Additonal Notes:<a class="headerlink" href="#additonal-notes" title="Permalink to this headline">¶</a></h4>
<p>We used the following query, using <strong>elf-res-wks2</strong> as the source and looked for successful network connections:
<code class="docutils literal notranslate"><span class="pre">SourceHostName:ELFU-RES-WKS2</span> <span class="pre">AND</span> <span class="pre">EventID:4624</span></code></p>
<p>The access occured at <strong>2019-11-19 06:07:22.000</strong>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The query is case-sensitive and the hostname must be in CAPITALS. We were initially unsuccessful with this question because we searched for <strong>elfu-res-wks2</strong> instead of <strong>ELFU-RES-WKS2</strong>.</p>
</div>
</div>
</div>
<div class="section" id="question-9">
<h3>Question 9:<a class="headerlink" href="#question-9" title="Permalink to this headline">¶</a></h3>
<p>What is the full-path + filename of the secret research document after being transferred from the third host to the second host?</p>
<div class="section" id="id22">
<h4>Answer:<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p><strong>C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf</strong></p>
</div>
<div class="section" id="id23">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h4>
<p>We can look for sysmon file creation event id of <strong>2</strong> with a source of workstation 2. We can also use regex to filter out overly common file paths using something like:
<code class="docutils literal notranslate"><span class="pre">AND</span> <span class="pre">NOT</span> <span class="pre">TargetFilename:/.+AppData.+/</span></code></p>
</div>
<div class="section" id="id24">
<h4>Additonal Notes:<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h4>
<p>We performed a search using:
<code class="docutils literal notranslate"><span class="pre">source:elfu-res-wks2</span> <span class="pre">AND</span> <span class="pre">EventID:2</span></code></p>
<p>The first event after <strong>2019-11-19 06:07:22.000</strong> has a <strong>TargetFilename</strong> of <strong>C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf</strong>. The timestamp for the event was <strong>2019-11-19 06:07:51.000</strong>.</p>
</div>
</div>
<div class="section" id="question-10">
<h3>Question 10:<a class="headerlink" href="#question-10" title="Permalink to this headline">¶</a></h3>
<p>What is the IPv4 address (as found in logs) the secret research document was exfiltrated to?</p>
<div class="section" id="id25">
<h4>Answer:<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<p><strong>104.22.3.84</strong></p>
</div>
<div class="section" id="id26">
<h4>Post-Answer Dialog:<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>We can look for the original document in <strong>CommandLine</strong> using regex.</p>
<p>When we do that, we see a long a long PowerShell command using <strong>Invoke-Webrequest</strong> to a remote URL of <strong>https://pastebin.com/post.php</strong>.</p>
<p>We can pivot off of this information to look for a sysmon network connection id of <strong>3</strong> with a source of <strong>elfu-res-wks2</strong> and <strong>DestinationHostname</strong> of <strong>pastebin.com</strong>.</p>
</div>
<div class="section" id="id27">
<h4>Additional Notes:<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p>The first search term we used was:
<code class="docutils literal notranslate"><span class="pre">CommandLine:/.+secret.+/</span></code></p>
<p>We found a command making use of <strong>pastebin.com</strong>. We pivoted off this imformation with the following search:
<code class="docutils literal notranslate"><span class="pre">DestinationHostname:pastebin.com</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dad complained that graylog seems too “gray”. Added this to change that.</p>
</div>
</div>
</div>
</div>
<div class="section" id="hints">
<h2>Hints<a class="headerlink" href="#hints" title="Permalink to this headline">¶</a></h2>
<p>Pepper Minstix provides the following hint in her dialog after solving the terminal challenge:</p>
<pre class="literal-block"><strong>Pepper Minstix</strong>
That's it - hooray!
Have you had any luck retrieving scraps of paper from the Elf U server?
You might want to look into SQL injection techniques.
You might want to look into SQL injection techniques.
OWASP is always a good resource for web attacks.
For blind SQLi, I've heard Sqlmap is a great tool.
In certain circumstances though, you need custom tamper scripts to get things going!</pre>
<p>The following hints were unlocked in our badge:</p>
<pre class="literal-block"><strong>SQLMap Tamper Scripts</strong>
From: Pepper Minstix
<a class="reference external" href="https://pen-testing.sans.org/blog/2017/10/13/sqlmap-tamper-scripts-for-the-win">Sqlmap Tamper Scripts</a></pre>
<pre class="literal-block"><strong>SQL Injection</strong>
From: Pepper Minstix
<a class="reference external" href="https://www.owasp.org/index.php/SQL_Injection">SQL Injection from OWASP</a></pre>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="MongoPilfer.html" class="btn btn-neutral float-right" title="Mongo Pilfer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Nyanshell.html" class="btn btn-neutral float-left" title="Nyanshell" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Peter and Antonios Lapornik

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>